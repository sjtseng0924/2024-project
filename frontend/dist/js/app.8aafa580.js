(function(){"use strict";var e={2173:function(e,t,o){var n=o(5130),s=o(6768);const a={id:"app"};function i(e,t,o,n,i,r){const l=(0,s.g2)("Navbar"),c=(0,s.g2)("router-view");return(0,s.uX)(),(0,s.CE)("div",a,[(0,s.bF)(l),(0,s.bF)(c,{class:"pb-[75px]"})])}var r=o(4232);const l={class:"bg-gray-900 text-gray-300 p-4 flex justify-between items-center"},c={class:"flex space-x-6"},m={class:"flex items-center space-x-4"},u={key:1,class:"flex items-center space-x-1 text-white"},d={class:"p-4 text-white"};function g(e,t,o,n,a,i){const g=(0,s.g2)("router-link");return(0,s.uX)(),(0,s.CE)("div",null,[(0,s.Lk)("nav",l,[t[5]||(t[5]=(0,s.Lk)("div",{class:"text-lg font-bold text-white"}," WebSiteName ",-1)),(0,s.Lk)("div",c,[a.isLoggedIn?((0,s.uX)(),(0,s.Wv)(g,{key:0,to:"/chatapp",class:"hover:text-white"},{default:(0,s.k6)((()=>t[1]||(t[1]=[(0,s.eW)("Chat App")]))),_:1})):(0,s.Q3)("",!0),a.isLoggedIn?((0,s.uX)(),(0,s.Wv)(g,{key:1,to:"/sticky_note",class:"hover:text-white"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)("Note Board")]))),_:1})):(0,s.Q3)("",!0),a.isLoggedIn?((0,s.uX)(),(0,s.Wv)(g,{key:2,to:"/map",class:"hover:text-white"},{default:(0,s.k6)((()=>t[3]||(t[3]=[(0,s.eW)("Map")]))),_:1})):(0,s.Q3)("",!0)]),(0,s.Lk)("div",m,[a.isLoggedIn?((0,s.uX)(),(0,s.CE)("span",u,[(0,s.Lk)("span",null,(0,r.v_)(a.username),1)])):((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[0]||(t[0]=(...e)=>i.login&&i.login(...e)),class:"flex items-center space-x-1 hover:text-white"},t[4]||(t[4]=[(0,s.Lk)("span",null,"🔒",-1),(0,s.eW)(),(0,s.Lk)("span",null,"Login",-1)])))])]),(0,s.Lk)("div",d,[((0,s.uX)(),(0,s.Wv)((0,s.$y)(a.currentPage)))])])}var h={data(){return{isLoggedIn:!1,username:"",currentPage:"LoginComponent"}},methods:{login(){this.isLoggedIn=!0,this.username="JohnDoe",this.currentPage="HomeComponent"}},components:{LoginComponent:{template:"<div>Please login to access the website.</div>"},HomeComponent:{template:"<div>Welcome to the Home Page!</div>"},Page1Component:{template:"<div>Page 1 Content</div>"},Page2Component:{template:"<div>Page 2 Content</div>"}}},p=o(1241);const v=(0,p.A)(h,[["render",g],["__scopeId","data-v-0b38012c"]]);var f=v,k={components:{Navbar:f}};const y=(0,p.A)(k,[["render",i]]);var L=y,b=o(1387);const w={class:"chat-app"},N={class:"navbar"},C={key:0},_={key:1},x={key:2,class:"navbar-right"},R={key:0,class:"register-container"},E={key:1},I={key:0,class:"room-container"},M={key:1};function X(e,t,o,a,i,l){const c=(0,s.g2)("ChatWindow");return(0,s.uX)(),(0,s.CE)("div",w,[(0,s.Lk)("nav",N,[i.inRoom?((0,s.uX)(),(0,s.CE)("h1",C,"Room: "+(0,r.v_)(i.roomName),1)):((0,s.uX)(),(0,s.CE)("h1",_,"Chat Application")),i.isRegistered?((0,s.uX)(),(0,s.CE)("div",x,[(0,s.Lk)("p",null,[t[5]||(t[5]=(0,s.eW)("Logged in as: ")),(0,s.Lk)("strong",null,(0,r.v_)(i.userName),1)]),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.logout&&l.logout(...e))},"Logout")])):(0,s.Q3)("",!0)]),i.isRegistered?((0,s.uX)(),(0,s.CE)("div",E,[i.inRoom?((0,s.uX)(),(0,s.CE)("div",M,[(0,s.bF)(c,{userName:i.userName,roomName:i.roomName,onLeftRoom:l.handleRoomExit},null,8,["userName","roomName","onLeftRoom"])])):((0,s.uX)(),(0,s.CE)("div",I,[t[7]||(t[7]=(0,s.Lk)("h2",null,"Select or Create a Room",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>i.roomName=e),placeholder:"Enter room name"},null,512),[[n.Jo,i.roomName]]),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>l.joinRoom&&l.joinRoom(...e))},"Join Room")]))])):((0,s.uX)(),(0,s.CE)("div",R,[t[6]||(t[6]=(0,s.Lk)("h2",null,"Login",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.userName=e),placeholder:"Enter your name"},null,512),[[n.Jo,i.userName]]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.login&&l.login(...e))},"Login")]))])}var S=o(4373);const O="http://127.0.0.1:8000/api/chatroom",j=S.A.create({baseURL:O,headers:{"Content-Type":"application/json"}});var T=j;const P=async e=>{try{const t=await T.post(`/newuser/${e}/`);return t.data}catch(t){if(t.response&&400===t.response.status)return{status:"User already exists",uuid:null};throw t}},W=async e=>{const t=await T.post(`/create/${e}/`);return t.data},A=async(e,t,o)=>{const n=await T.post(`/send/${e}/`,{name:t,message:o});return n.data},U=async e=>{const t=await T.get(`/messages/${e}/`);return t.data.messages},$={class:"chat-window"},F={class:"messages",ref:"messagesContainer"},J={class:"message-input"},D=["disabled"],Q={class:"chat-footer"};function V(e,t,o,a,i,r){const l=(0,s.g2)("Message");return(0,s.uX)(),(0,s.CE)("div",$,[(0,s.Lk)("div",F,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(i.messages,(e=>((0,s.uX)(),(0,s.Wv)(l,{key:e.time,message:e,isOwnMessage:e.sender_name===o.userName},null,8,["message","isOwnMessage"])))),128))],512),(0,s.Lk)("div",J,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.newMessage=e),onKeyup:t[1]||(t[1]=(0,n.jR)(((...e)=>r.send&&r.send(...e)),["enter"])),placeholder:"Type your message..."},null,544),[[n.Jo,i.newMessage]]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>r.send&&r.send(...e)),disabled:i.sending},"Send",8,D)]),(0,s.Lk)("div",Q,[(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>r.leaveRoom&&r.leaveRoom(...e)),class:"leave-btn"},"Leave Room")])])}const B={class:"message-info"},H={class:"sender"},K={class:"time"},q={class:"message-content"};function z(e,t,o,n,a,i){return(0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(["message",o.isOwnMessage?"own":""])},[(0,s.Lk)("div",B,[(0,s.Lk)("span",H,(0,r.v_)(o.message.sender_name),1),(0,s.Lk)("span",K,(0,r.v_)(i.formattedTime),1)]),(0,s.Lk)("div",q,(0,r.v_)(o.message.content),1)],2)}var G={name:"ChatMessage",props:{message:Object,isOwnMessage:Boolean},computed:{formattedTime(){const e=new Date(this.message.time);return e.toLocaleTimeString()}}};const Y=(0,p.A)(G,[["render",z],["__scopeId","data-v-478791ee"]]);var Z=Y,ee={components:{Message:Z},props:{userName:String,roomName:String},data(){return{messages:[],newMessage:"",sending:!1,intervalId:null}},methods:{async fetchMessages(){try{this.messages=await U(this.roomName),this.$nextTick((()=>{this.scrollToBottom()}))}catch(e){console.error(e)}},async send(){if(this.newMessage.trim()&&!this.sending){this.sending=!0;try{await A(this.roomName,this.userName,this.newMessage),this.newMessage="",this.fetchMessages()}catch(e){console.error(e)}finally{this.sending=!1}}},scrollToBottom(){const e=this.$refs.messagesContainer;e.scrollTop=e.scrollHeight},leaveRoom(){localStorage.removeItem("roomName"),this.$emit("left-room")}},mounted(){this.fetchMessages(),this.intervalId=setInterval(this.fetchMessages,3e3)},beforeUnmount(){clearInterval(this.intervalId)}};const te=(0,p.A)(ee,[["render",V],["__scopeId","data-v-a1c0eb78"]]);var oe=te,ne={components:{ChatWindow:oe},data(){return{userName:"",roomName:"",isRegistered:!1,inRoom:!1}},methods:{async login(){if(this.userName.trim())try{const e=await P(this.userName);"User already exists"===e.status?alert("Welcome back! Logging in..."):alert("User created successfully!"),this.isRegistered=!0,localStorage.setItem("userName",this.userName)}catch(e){alert(e.message||"Login failed.")}else alert("Please enter a username.")},async joinRoom(){if(this.roomName.trim())try{await W(this.roomName),this.inRoom=!0,localStorage.setItem("roomName",this.roomName)}catch(e){alert(e.message||"Failed to join or create room.")}else alert("Please enter a room name.")},handleRoomExit(){this.roomName="",this.inRoom=!1,localStorage.removeItem("roomName")},logout(){this.userName="",this.roomName="",this.isRegistered=!1,this.inRoom=!1,localStorage.removeItem("userName"),localStorage.removeItem("roomName")}},mounted(){const e=localStorage.getItem("userName"),t=localStorage.getItem("roomName");e&&(this.userName=e,this.isRegistered=!0),t&&(this.roomName=t,this.inRoom=!0)}};const se=(0,p.A)(ne,[["render",X],["__scopeId","data-v-3bc3e140"]]);var ae=se;const ie={class:"message-board"},re={class:"message-content"},le={class:"message-time"},ce={class:"like-section"},me=["onClick"],ue={key:0,class:"modal-overlay"},de={class:"modal"};function ge(e,t,o,a,i,l){return(0,s.uX)(),(0,s.CE)("div",ie,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.sortedNotes,((e,t)=>((0,s.uX)(),(0,s.CE)("div",{key:t,class:"message-card"},[(0,s.Lk)("p",re,(0,r.v_)(e.content),1),(0,s.Lk)("p",le,(0,r.v_)(l.formatTime(e.time)),1),(0,s.Lk)("div",ce,[(0,s.Lk)("button",{onClick:t=>l.likeNote(e.id)},"👍 "+(0,r.v_)(e.likes)+" Likes",9,me)])])))),128)),(0,s.Lk)("button",{class:"add-note-button",onClick:t[0]||(t[0]=e=>i.showModal=!0)},"+"),i.showModal?((0,s.uX)(),(0,s.CE)("div",ue,[(0,s.Lk)("div",de,[(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[1]||(t[1]=e=>i.newNoteContent=e),placeholder:"輸入留言內容"},null,512),[[n.Jo,i.newNoteContent]]),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>l.submitNote&&l.submitNote(...e))},"新增"),(0,s.Lk)("button",{onClick:t[3]||(t[3]=e=>i.showModal=!1)},"取消")])])):(0,s.Q3)("",!0)])}o(4114);const he="http://127.0.0.1:8000/api/stickynotes",pe=S.A.create({baseURL:he,headers:{"Content-Type":"application/json"}});var ve=pe;const fe=async e=>{const t=await ve.post("/add/",{note_content:e});return t.data},ke=async()=>{const e=await ve.post("/get/");return e.data};var ye={data(){return{notes:[{id:1,content:"便條 1",time:0,likes:0},{id:2,content:"便條 2",time:0,likes:0},{id:3,content:"便條 3",time:0,likes:5},{id:4,content:"便條 4",time:0,likes:2}],showModal:!1,newNoteContent:""}},computed:{sortedNotes(){return[...this.notes].sort(((e,t)=>t.likes===e.likes?t.time-e.time:t.likes-e.likes))}},methods:{async fetchNotes(){try{this.notes=await ke()}catch(e){console.error(e)}},async submitNote(){if(!this.newNoteContent.trim())return void alert("請輸入留言內容");const e={id:this.notes.length+1,content:this.newNoteContent,time:Date.now(),likes:0};try{this.notes.push(e),this.newNoteContent="",this.showModal=!1,this.fetchNotes(),await fe(e.content)}catch(t){alert(t.message||"新增留言失敗")}},likeNote(e){const t=this.notes.find((t=>t.id===e));t&&(t.likes+=1)},formatTime(e){const t=new Date(e);return t.toLocaleString()}},mounted(){this.fetchNotes()}};const Le=(0,p.A)(ye,[["render",ge],["__scopeId","data-v-2515e8f0"]]);var be=Le;const we={class:"login-container"};function Ne(e,t,o,a,i,r){return(0,s.uX)(),(0,s.CE)("div",we,[t[3]||(t[3]=(0,s.Lk)("h2",null,"Login",-1)),(0,s.Lk)("form",{onSubmit:t[1]||(t[1]=(0,n.D$)(((...e)=>r.handleLogin&&r.handleLogin(...e)),["prevent"]))},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>i.username=e),type:"text",placeholder:"Enter your name",class:"input-field"},null,512),[[n.Jo,i.username]]),t[2]||(t[2]=(0,s.Lk)("button",{type:"submit",class:"login-button"},"Login",-1))],32)])}var Ce={data(){return{username:""}},methods:{handleLogin(){this.username&&console.log(`Logging in as: ${this.username}`)}}};const _e=(0,p.A)(Ce,[["render",Ne],["__scopeId","data-v-27605f6e"]]);var xe=_e;const Re=[{path:"/chatapp",name:"chatapp",component:ae},{path:"/sticky_note",name:"stickynote",component:be},{path:"/login",name:"login",component:xe}],Ee=(0,b.aE)({history:(0,b.LA)("/"),routes:Re});var Ie=Ee;(0,n.Ef)(L).use(Ie).mount("#app")}},t={};function o(n){var s=t[n];if(void 0!==s)return s.exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,o),a.exports}o.m=e,function(){var e=[];o.O=function(t,n,s,a){if(!n){var i=1/0;for(m=0;m<e.length;m++){n=e[m][0],s=e[m][1],a=e[m][2];for(var r=!0,l=0;l<n.length;l++)(!1&a||i>=a)&&Object.keys(o.O).every((function(e){return o.O[e](n[l])}))?n.splice(l--,1):(r=!1,a<i&&(i=a));if(r){e.splice(m--,1);var c=s();void 0!==c&&(t=c)}}return t}a=a||0;for(var m=e.length;m>0&&e[m-1][2]>a;m--)e[m]=e[m-1];e[m]=[n,s,a]}}(),function(){o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,{a:t}),t}}(),function(){o.d=function(e,t){for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};o.O.j=function(t){return 0===e[t]};var t=function(t,n){var s,a,i=n[0],r=n[1],l=n[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(s in r)o.o(r,s)&&(o.m[s]=r[s]);if(l)var m=l(o)}for(t&&t(n);c<i.length;c++)a=i[c],o.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return o.O(m)},n=self["webpackChunkfrontend"]=self["webpackChunkfrontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=o.O(void 0,[504],(function(){return o(2173)}));n=o.O(n)})();
//# sourceMappingURL=app.8aafa580.js.map